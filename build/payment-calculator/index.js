(()=>{"use strict";const e=window.wp.blocks;function t(){return t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a])}return e},t.apply(this,arguments)}const l=window.wp.element,a=window.wp.i18n,n=window.wp.blockEditor,r=window.wp.components,o=window.wp.data,c=window.wp.coreData;(0,e.registerBlockType)("inventory-presser/invp-payment-calculator",{edit:function({attributes:e,setAttributes:p}){var u;const i=(0,n.useBlockProps)(),m=(0,o.useSelect)((e=>e("core/editor").getCurrentPostType()),[]),[s,v]=(0,c.useEntityProp)("postType",m,"meta");function _(t=null,l=null,a=null){var n,r=s[invp_blocks.meta_prefix+"price"],o=t||e.trade,c=l||e.apr,p=a||e.term;return n=0==(c/=1200)?p:(1-1/Math.pow(1+c,p))/c,function(e){e=e.toString().replace(/\$|\,/g,""),isNaN(e)&&(e="0");var t=e==(e=Math.abs(e)),l=(e=Math.floor(100*e+.50000000001))%100;e=Math.floor(e/100).toString(),l<10&&(l="0"+l);for(var a=0;a<Math.floor((e.length-(1+a))/3);a++)e=e.substring(0,e.length-(4*a+3))+","+e.substring(e.length-(4*a+3));return(t?"":"-")+"$"+e+"."+l}(Math.round((r-o)/n*100)/100)}return(0,l.createElement)(l.Fragment,null,(0,l.createElement)(n.InspectorControls,null,(0,l.createElement)(r.PanelBody,{title:(0,a.__)("Settings","invp-payment-calculator"),initialOpen:!0},(0,l.createElement)(r.PanelRow,null,(0,l.createElement)("fieldset",null,(0,l.createElement)(r.TextControl,{label:(0,a.__)("Default APR","invp-payment-calculator"),help:(0,a.__)("What annual percentage rate should be pre-filled?","invp-payment-calculator"),value:e.defaultAPR,onChange:e=>{p({defaultAPR:parseFloat(e.replace(/[^0-9\.]+/g,""))})}}))))),(0,l.createElement)(n.BlockControls,null),(0,l.createElement)("div",t({},i,{id:"payment_calculator"}),(0,l.createElement)("ul",null,(0,l.createElement)("li",null,(0,l.createElement)(r.TextControl,{label:(0,a.__)("Cash/trade","invp-payment-calculator"),id:"trade",value:e.trade,onChange:e=>{e=e.replace(/[^0-9\.]+/g,""),p({trade:e}),p({payment:_(e)})}})),(0,l.createElement)("li",null,(0,l.createElement)(r.TextControl,{label:(0,a.__)("APR %*","invp-payment-calculator"),id:"apr",value:null!==(u=e.APR)&&void 0!==u?u:e.defaultAPR,onChange:e=>{e=e.replace(/[^0-9\.]+/g,""),p({APR:e}),p({payment:_(null,e)})}})),(0,l.createElement)("li",null,(0,l.createElement)(r.SelectControl,{label:(0,a.__)("Term","invp-payment-calculator"),id:"term",value:e.defaultTerm,options:[{label:(0,a.__)("12 months","invp-payment-calculator"),value:"12"},{label:(0,a.__)("18 months","invp-payment-calculator"),value:"18"},{label:(0,a.__)("24 months","invp-payment-calculator"),value:"24"},{label:(0,a.__)("30 months","invp-payment-calculator"),value:"30"},{label:(0,a.__)("36 months","invp-payment-calculator"),value:"36"},{label:(0,a.__)("42 months","invp-payment-calculator"),value:"42"},{label:(0,a.__)("48 months","invp-payment-calculator"),value:"48"},{label:(0,a.__)("60 months","invp-payment-calculator"),value:"60"},{label:(0,a.__)("72 months","invp-payment-calculator"),value:"72"},{label:(0,a.__)("84 months","invp-payment-calculator"),value:"84"}]})),(0,l.createElement)("li",null,(0,l.createElement)(r.TextControl,{label:(0,a.__)("Payment","invp-payment-calculator"),id:"payment",value:_,onChange:()=>{p({payment:_()})}}))),(0,l.createElement)("p",null,"* ",e.disclaimer),(0,l.createElement)("input",{type:"hidden",id:"loan_amount",value:s[invp_blocks.meta_prefix+"price"]})))},save:function(){return null}})})();